# Simple AI Chat App - 要件定義書

## 1. プロジェクト概要

**プロジェクト名**: Simple AI Chat App  
**目的**: Gemini APIを使った簡単なチャットアプリ  
**技術スタック**: Next.js 14.x + React 18.x + Tailwind CSS v3

---

## 2. 機能要件

### 2-1. 基本機能
- ✅ Gemini APIとのチャット機能
- ✅ 会話履歴保存なし（セッションのみ）
- ✅ 会話リセット機能（新しい会話を始める）
- ✅ APIキーはローカルストレージで管理

### 2-2. UI/UX要件（UX心理学ガイド適用）

| 項目 | 設計方針 | 根拠 |
|------|----------|------|
| レイアウト | 全画面表示 | 集中力維持 |
| 送信ボタン | 主役として大きく・高コントラスト | 視覚的階層 |
| ローディング | スケルトンUI + メッセージ表示 | ドハティの閾値対策 |
| 入力欄 | 即座にフォーカス | 認知負荷軽減 |
| リセットボタン | 右上に小さく配置 | 視覚的階層（副次的要素） |

### 2-3. セキュリティ要件
- ✅ APIキーは localStorage に保存
- ✅ 初回アクセス時にAPIキー入力モーダル表示
- ✅ APIキー設定変更機能（設定アイコン）

---

## 3. 非機能要件

### 3-1. レスポンス速度
- 送信ボタン押下後、**即座に**ローディング表示開始
- 0.4秒以内に視覚的フィードバック提供

### 3-2. UX心理学適用項目

| 心理効果 | 実装内容 |
|----------|----------|
| **即座のフィードバック** | 送信直後にローディングアニメーション |
| **視覚的階層** | 送信ボタン: 大きく・鮮やかな色 |
| **認知負荷軽減** | 初期画面はシンプル（入力欄+ボタンのみ） |
| **美的ユーザビリティ** | 余白・整列を意識したデザイン |

---

## 4. 画面設計

### 4-1. メイン画面構成
```
┌─────────────────────────────────┐
│ [ヘッダー]                [🔄] │ ← リセットボタン（右上）
├─────────────────────────────────┤
│                                 │
│  [チャット履歴エリア]           │ ← 中央スクロール可能
│   - ユーザーメッセージ          │
│   - AIメッセージ                │
│   - ローディング表示            │
│                                 │
├─────────────────────────────────┤
│ [入力欄（大きめ）]              │
│ [送信ボタン（主役・大きい）]    │ ← 固定フッター
└─────────────────────────────────┘
```

### 4-2. APIキー設定モーダル
- 初回アクセス時に自動表示
- 右上の設定アイコンから再表示可能
- 入力欄 + 保存ボタン

---

## 5. 技術仕様

### 5-1. ディレクトリ構成
```
simple-ai-chat/
├── app/
│   ├── page.tsx          # メインページ
│   ├── layout.tsx
│   └── globals.css
├── components/
│   ├── ChatMessage.tsx   # メッセージコンポーネント
│   ├── ChatInput.tsx     # 入力欄コンポーネント
│   ├── LoadingMessage.tsx # ローディング表示
│   ├── Header.tsx        # ヘッダーコンポーネント
│   └── ApiKeyModal.tsx   # APIキー設定モーダル
├── lib/
│   └── gemini.ts         # Gemini API関連（SDK使用）
├── package.json
└── tailwind.config.ts
```

### 5-2. 使用パッケージ
- `next`: 14.x
- `react`: 18.x
- `@google/generative-ai`: latest（Gemini SDK）
- `tailwindcss`: 3.x

### 5-3. 状態管理
- React Hooks（useState）で実装
- 状態:
  - `messages`: メッセージ配列
  - `input`: 入力テキスト
  - `isLoading`: ローディング状態
  - `apiKey`: APIキー（localStorage同期）

---

## 6. 開発手順（TDD準拠）

1. **環境構築**: Next.js プロジェクト作成
2. **コンポーネント設計**: 各UIコンポーネント作成
3. **Gemini API統合**: SDK使用してAPI呼び出し機能実装
4. **ローディング実装**: スケルトンUI追加
5. **APIキー管理**: localStorage連携
6. **動作確認**: 全機能テスト

---

## 7. API仕様

### 7-1. Gemini SDK使用
- パッケージ: `@google/generative-ai`
- モデル: `gemini-pro`
- 実装場所: `lib/gemini.ts`

### 7-2. メッセージフォーマット
```typescript
interface Message {
  role: 'user' | 'assistant';
  content: string;
}
```

---

## 参考資料

- UX心理学に基づくUI設計ガイド（添付ドキュメント参照）
